diff --git a/bcos-sdk/bcos-cpp-sdk/SdkFactory.cpp b/bcos-sdk/bcos-cpp-sdk/SdkFactory.cpp
index 065b8c1..f6c6ef9 100644
--- a/bcos-sdk/bcos-cpp-sdk/SdkFactory.cpp
+++ b/bcos-sdk/bcos-cpp-sdk/SdkFactory.cpp
@@ -127,15 +127,26 @@ bcos::cppsdk::jsonrpc::JsonRpcImpl::Ptr SdkFactory::buildJsonRpc(
     BCOS_LOG(INFO) << "[buildJsonRpc]" << LOG_DESC("build json rpc")
                    << LOG_KV("sendRequestToHighestBlockNode", _sendRequestToHighestBlockNode);
 
-    jsonRpc->setSender([_service](const std::string& _group, const std::string& _node,
+    // 使用 weak_ptr 避免循环引用导致内存泄漏
+    auto weakService = std::weak_ptr<Service>(_service);
+    jsonRpc->setSender([weakService](const std::string& _group, const std::string& _node,
                            const std::string& _request, auto&& _respFunc) {
+        auto service = weakService.lock();
+        if (!service) {
+            if (_respFunc) {
+                auto error = std::make_shared<Error>();
+                *error << Error::ErrorCode(-1) << Error::ErrorMessage("service has been destroyed");
+                _respFunc(error, nullptr);
+            }
+            return;
+        }
         auto data = std::make_shared<bytes>(_request.begin(), _request.end());
-        auto msg = _service->messageFactory()->buildMessage();
-        msg->setSeq(_service->messageFactory()->newSeq());
+        auto msg = service->messageFactory()->buildMessage();
+        msg->setSeq(service->messageFactory()->newSeq());
         msg->setPacketType(bcos::protocol::MessageType::RPC_REQUEST);
         msg->setPayload(data);
 
-        _service->asyncSendMessageByGroupAndNode(_group, _node, msg, Options(),
+        service->asyncSendMessageByGroupAndNode(_group, _node, msg, Options(),
             [_respFunc](Error::Ptr _error, MessageFace::Ptr _msg, auto&& _session) {
                 (void)_session;
                 _respFunc(_error, _msg ? _msg->payload() : nullptr);
